import React, { useEffect, useRef, useState } from 'react';
import { dpr, GameBase } from '../canvas/gameBase';

export default function Game(props: { className?: string }): JSX.Element {
  const gameCanvas = useRef<HTMLCanvasElement>();
  const [gameBase, setGameBase] = useState<GameBase>();
  const [gaming, setGaming] = useState<boolean>(false);
  useEffect(() => {
    setGameBase(
      new GameBase(
        gameCanvas.current,
        [
          {
            x: 1,
            y: 2,
            typeCode: 1,
          },
          {
            x: 4,
            y: 2,
            typeCode: 3,
          },
          {
            x: 4,
            y: 8,
            typeCode: 2,
          },
        ],
        { x: 2, y: 4, color: '#fce38a' },
      ),
    );
  }, []);
  useEffect(() => {
    gameBase?.draw();
  }, [gameBase]);
  return (
    <>
      <svg
        id="tank"
        className="icon"
        viewBox="0 0 2546 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="3721"
        width="200"
        height="200"
      >
        <path
          d="M2499.632137 186.525538c-306.250393-13.443282-612.562051-8.065094-918.87371-2.700034-65.80294 40.08041-68.174769-37.669197-102.855111-55.357265-34.759111-39.283966-81.661812-8.502701-121.063931-21.048889-26.247658-63.347966-70.940444-88.45347-141.211351-80.948512-62.385231 6.664752-126.043897 0.643282-189.098666 2.030495-19.994256 0.437607-54.044444-11.679726-51.108103 25.490599 5.356308 67.745915-40.154803 54.377026-78.353504 54.66147-42.999248 0.297573-86.536752 4.284171-128.923351-0.910223-71.076103-8.695248-114.246017 10.703863-111.795419 90.116377-59.619556-12.769368-102.614427-6.472205-82.611418 72.051965-5.465709 5.662632-10.953299 11.325265-16.427761 16.99665-161.603829-1.973607-323.225162-8.502701-484.710838 3.492103-90.584615 75.819761-58.840615 168.907487-36.780854 260.634256l12.428034 16.510906c31.372034 37.428513 100.522667-24.024615 122.744342 58.328615 51.388171 190.538393 201.255385 291.542427 369.725265 369.808411 381.17306 14.738598 762.363624 11.92041 1143.567316 1.251555 210.475761-13.850256 364.605265-115.265641 456.345162-304.158632 31.245128-64.315077 50.578598-137.11535-23.075008-193.619146-3.225162-5.614496-7.82441-7.229265-13.850257-4.809299-92.899556-28.409436-188.105299-4.511726-281.893196-12.550564-27.468581-2.354325-57.632821 8.410803-78.99241-21.13641-39.498393-54.63959-80.602803-108.13265-128.875214-172.544 282.252034 0 547.157333-3.010735 811.93135 1.689162 88.379077 1.597265 104.916239-28.965197 73.758633-103.27959zM103.113299 556.902838c-0.853333 0.113778-1.737299 0.013128-2.616889 0.091897-0.507624-0.398222-0.997744-0.748308-1.509743-1.137778 7.491829-3.05012 8.441436-3.548991 4.126632 1.045881z m1759.284513-53.519317h0.008752l5.745778 0.652035c-23.958974-0.039385-47.900444 0.280068-71.859419 1.417846 22.020376-1.706667 44.05388-2.131145 66.104889-2.069881z m-67.671521 269.880889l84.668171-52.862906c15.079932-9.417299 37.682325-0.437607 50.4867 20.064274l9.268513 14.848c12.8 20.50188 10.948923 44.758427-4.131008 54.17135l-84.668171 52.862906c-15.079932 9.417299-37.686701 0.437607-50.491077-20.068649l-9.268513-14.848c-12.8-20.497504-10.944547-44.749675 4.135385-54.166975zM1288.021333 319.452991c0-24.169026 19.596034-43.760684 43.760684-43.760683h148.786325c24.16465 0 48.136752 19.727316 61.264957 43.760683l60.53853 98.496547c31.358906 49.593983-41.480752 41.537641-65.645402 41.537641h-204.94441c-24.16465 0-43.760684-19.591658-43.760684-43.760683V319.452991zM472.037744 791.587009l-10.016821 14.35788c-13.832752 19.819214-37.594803 27.127248-53.077333 16.318359l-92.518838-64.564513c-15.48253-10.804513-16.821607-35.629949-2.993231-55.449162l10.016821-14.353505c13.832752-19.819214 37.594803-27.127248 53.077333-16.318359l92.518838 64.564513c15.486906 10.800137 16.825983 35.625573 2.993231 55.444787zM866.461538 888.34188c0 24.16465-19.591658 43.760684-43.760683 43.760684h-188.17094c-24.169026 0-43.760684-19.596034-43.760684-43.760684v-30.632478c0-24.16465 19.591658-43.760684 43.760684-43.760684h188.17094c24.169026 0 43.760684 19.596034 43.760683 43.760684v30.632478z m396.585573 0c0 24.16465-19.596034 43.760684-43.760684 43.760684H1041.504274c-24.169026 0-43.760684-19.596034-43.760684-43.760684v-30.632478c0-24.16465 19.591658-43.760684 43.760684-43.760684h177.777777c24.169026 0 43.760684 19.596034 43.760684 43.760684v30.632478zM1623.521368 888.34188c0 24.16465-19.596034 43.760684-43.760684 43.760684h-153.162393c-24.16465 0-43.760684-19.596034-43.760684-43.760684v-30.632478c0-24.16465 19.596034-43.760684 43.760684-43.760684h153.162393c24.16465 0 43.760684 19.596034 43.760684 43.760684v30.632478z m56.455658-372.823521a13.55706 13.55706 0 1 1 0 27.11412H223.608342a13.55706 13.55706 0 1 1 0-27.11412h1456.368684z"
          fill=""
          p-id="3722"
        />
      </svg>
      <svg
        id="bullet"
        className="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        width="200"
        height="200"
      >
        <path d="M514 512.4m-445.4 0a445.4 445.4 0 1 0 890.8 0 445.4 445.4 0 1 0-890.8 0Z" fill="" />
      </svg>
      <div className="sidebar">
        <button
          onClick={() => {
            gaming ? gameBase.gamePauses() : gameBase.gameStart();
            setGaming((value) => !value);
          }}
        >
          {gaming ? '暂停' : '开始'}
        </button>
      </div>
      <canvas
        style={{
          width: 750 / dpr,
          height: 750 / dpr,
        }}
        ref={gameCanvas}
        className={props.className}
      />
      <div className="sidebar" />
    </>
  );
}
